
veracode_pippeline_scan::
  push:
    trigger: true
    branches_to_run:
      - 'feature/*'
  pull_request:
    trigger: true
    action:
      - opened
      - synchronize
    target_branch:
      - develop
  analysis_on_platform: false
  break_build_on_error: true
  break_build_policy_findings: false
  policy: 'Veracode Recommended Medium + SCA'
  create_code_scanning_alert: true
  create_issue: false
  error_message: "‚ùå Pipeline Scan fall√≥. Revisa los findings en el artefacto del workflow."
  issues:
    trigger: false

veracode_sca_scan_feature:
  push:
    trigger: true
    branches_to_run:
      - 'feature/*'
  break_build_on_error: true
  create_code_scanning_alert: true
  create_issue: false
  error_message: "‚ùå SCA Scan fall√≥ en rama feature."

veracode_sandbox_scan_develop:
  push:
    trigger: true
    branches_to_run:
      - develop
  analysis_on_platform: true        # Subir resultados al sandbox Veracode
  break_build_on_error: true
  break_build_policy_findings: true
  policy: 'Veracode Recommended Medium + SCA'
  create_code_scanning_alert: true
  create_issue: false
  error_message: "‚ö†Ô∏è Sandbox scan fall√≥ en develop. Revisa los resultados en Veracode."
  issues:
    trigger: false

veracode_sca_scan_develop:
  push:
    trigger: true
    branches_to_run:
      - develop
  break_build_on_error: true
  create_code_scanning_alert: true
  create_issue: false
  error_message: "‚ùå SCA Scan fall√≥ en develop."

veracode_upload_and_scan_main:
  push:
    trigger: true
    branches_to_run:
      - main
  pull_request:
    trigger: true
    target_branch:
      - main
  analysis_on_platform: true  
  break_build_on_error: true
  break_build_policy_findings: true
  break_build_invalid_policy: true
  policy: 'Veracode Recommended Medium + SCA'
  create_code_scanning_alert: true
  create_issue: false
  error_message: "üö´ Policy scan fall√≥. Corrige vulnerabilidades cr√≠ticas antes del merge."
  issues:
    trigger: false